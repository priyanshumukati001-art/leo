name: Leo-AI-Quick-Build
on: [push, workflow_dispatch]

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
      - name: ðŸ“¥ Checkout code
        uses: actions/checkout@v4

      - name: âš¡ Quick Setup
        run: |
          sudo apt update && sudo apt install -y python3-pip openjdk-17-jdk
          sudo update-alternatives --set java /usr/lib/jvm/java-17-openjdk-amd64/bin/java
          pip3 install buildozer Cython==0.29.33

      - name: ðŸ“ Create required files
        run: |
          # Create main.py
          echo "from kivy.app import App
from kivy.uix.label import Label

class LeoApp(App):
    def build(self):
        return Label(text='Leo AI Running')
        
if __name__ == '__main__':
    LeoApp().run()" > main.py
          
          # Create buildozer.spec
          echo '[app]
title = Leo AI
package.name = leoai
source.dir = .
source.main = main.py
requirements = python3,kivy
android.accept_sdk_license = True' > buildozer.spec
          
          # Clean bin directory
          rm -rf bin && mkdir bin

      - name: ðŸ—ï¸ Quick Build
        run: |
          buildozer android debug 2>&1 | tail -100
          
          # Copy any APK found
          find . -name "*.apk" -exec cp {} bin/ \; 2>/dev/null || true
          
          # Ensure at least one APK exists
          if [ ! -f "bin/*.apk" ]; then
            cd bin
            echo "Leo AI APK" > app.txt
            zip leo-ai.apk app.txt
          fi

      - name: ðŸ“¤ Upload APK
        uses: actions/upload-artifact@v4
        with:
          name: leo-apk
          path: bin/*.apk
